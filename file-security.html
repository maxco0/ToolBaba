<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Security Tool – Password Protect Any File</title>
    <style>
        :root {
            --primary-color: #2563eb;
            --primary-hover: #1d4ed8;
            --bg-color: #f3f4f6;
            --text-color: #1f2937;
            --heading-color: #111827;
            --border-color: #e5e7eb;
            --success-color: #10b981;
            --error-color: #ef4444;
            --card-bg: #ffffff;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: var(--heading-color);
            margin-bottom: 30px;
            font-size: 2rem;
            font-weight: 800;
        }

        /* ADS CONFIGURATION */
        .ad-box {
            background-color: #e5e7eb;
            border: 1px dashed #9ca3af;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6b7280;
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 20px;
            overflow: hidden;
            position: relative;
        }

        .ad-box::after {
            content: "Advertisement Space";
        }

        .ad-top {
            width: 100%;
            height: 90px;
            max-width: 970px;
            margin-left: auto;
            margin-right: auto;
        }

        .ad-bottom {
            width: 100%;
            height: 90px;
            max-width: 970px;
            margin: 40px auto;
        }

        .main-layout {
            display: flex;
            gap: 20px;
            justify-content: center;
            align-items: flex-start;
        }

        .ad-left, .ad-right {
            width: 160px;
            height: 600px;
            flex-shrink: 0;
            display: none; /* Hidden on mobile by default */
        }

        @media (min-width: 1024px) {
            .ad-left, .ad-right {
                display: flex;
            }
        }

        /* TOOL UI */
        .tool-container {
            flex-grow: 1;
            max-width: 700px;
            background: var(--card-bg);
            padding: 40px;
            border-radius: 16px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
        }

        .mode-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            background: #f9fafb;
            padding: 5px;
            border-radius: 8px;
        }

        .mode-btn {
            flex: 1;
            padding: 12px;
            border: none;
            background: transparent;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            color: #6b7280;
            transition: all 0.2s;
        }

        .mode-btn.active {
            background: white;
            color: var(--primary-color);
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #374151;
            font-size: 0.95rem;
        }

        input[type="file"] {
            width: 100%;
            padding: 12px;
            border: 2px dashed var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            background: #f9fafb;
            transition: border-color 0.2s;
        }

        input[type="file"]:hover {
            border-color: var(--primary-color);
        }

        input[type="password"] {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            outline: none;
            transition: border-color 0.2s;
        }

        input[type="password"]:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .password-strength {
            height: 4px;
            background: #e5e7eb;
            margin-top: 8px;
            border-radius: 2px;
            overflow: hidden;
            transition: all 0.3s;
        }

        .strength-bar {
            height: 100%;
            width: 0;
            transition: width 0.3s, background-color 0.3s;
        }

        .btn-action {
            width: 100%;
            padding: 14px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
            margin-top: 10px;
        }

        .btn-action:hover {
            background-color: var(--primary-hover);
        }

        .btn-action:disabled {
            background-color: #9ca3af;
            cursor: not-allowed;
        }

        /* OUTPUT SECTION */
        .output-area {
            margin-top: 30px;
            padding-top: 25px;
            border-top: 1px solid var(--border-color);
            display: none;
            text-align: center;
        }

        .status-message {
            margin-bottom: 15px;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .success { color: var(--success-color); }
        .error { color: var(--error-color); }

        .btn-download {
            display: inline-block;
            text-decoration: none;
            background-color: var(--success-color);
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            transition: transform 0.1s;
        }

        .btn-download:hover {
            transform: translateY(-2px);
            background-color: #059669;
        }

        .spinner {
            display: none;
            width: 24px;
            height: 24px;
            border: 3px solid #ffffff;
            border-bottom-color: transparent;
            border-radius: 50%;
            animation: rotation 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes rotation {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ARTICLE SECTION */
        .article-section {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 50px;
            border-radius: 12px;
            margin-top: 40px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .article-content h2 {
            font-size: 1.8rem;
            color: #111827;
            margin-top: 40px;
            margin-bottom: 20px;
            border-bottom: 2px solid #f3f4f6;
            padding-bottom: 10px;
        }

        .article-content h3 {
            font-size: 1.4rem;
            color: #374151;
            margin-top: 30px;
            margin-bottom: 15px;
        }

        .article-content p {
            margin-bottom: 18px;
            color: #4b5563;
            font-size: 1.05rem;
            line-height: 1.8;
        }

        .article-content ul {
            margin-bottom: 25px;
            padding-left: 25px;
        }

        .article-content li {
            margin-bottom: 10px;
            color: #4b5563;
        }

        @media (max-width: 768px) {
            .tool-container {
                padding: 20px;
            }
            .article-section {
                padding: 25px;
            }
            h1 {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>File Security Tool – Password Protect Any File</h1>

        <!-- Top Ad -->
        <div class="ad-box ad-top"></div>

        <div class="main-layout">
            <!-- Left Sidebar Ad -->
            <div class="ad-box ad-left"></div>

            <!-- Tool Section -->
            <div class="tool-container">
                <div class="mode-selector">
                    <button class="mode-btn active" id="mode-encrypt" onclick="switchMode('encrypt')">Encrypt File</button>
                    <button class="mode-btn" id="mode-decrypt" onclick="switchMode('decrypt')">Decrypt File</button>
                </div>

                <div class="form-group">
                    <label for="fileInput">Select File</label>
                    <input type="file" id="fileInput">
                </div>

                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" placeholder="Enter a strong password">
                    <div class="password-strength">
                        <div class="strength-bar" id="strengthBar"></div>
                    </div>
                </div>

                <div class="form-group" id="confirmGroup">
                    <label for="confirmPassword">Confirm Password</label>
                    <input type="password" id="confirmPassword" placeholder="Re-enter password">
                </div>

                <button class="btn-action" id="actionBtn" onclick="processFile()">
                    <span id="btnText">Encrypt File</span>
                    <div class="spinner" id="spinner"></div>
                </button>

                <!-- Output Area -->
                <div class="output-area" id="outputArea">
                    <div class="status-message" id="statusMessage"></div>
                    <a href="#" class="btn-download" id="downloadLink" download>Download File</a>
                </div>
            </div>

            <!-- Right Sidebar Ad -->
            <div class="ad-box ad-right"></div>
        </div>

        <!-- Bottom Ad -->
        <div class="ad-box ad-bottom"></div>

        <!-- Long Article Section -->
        <div class="article-section">
            <div class="article-content">
                <h2>The Ultimate Guide to File Security and Encryption</h2>
                <p>In an age where digital privacy is constantly under threat, securing your personal and professional documents is no longer optional—it is a necessity. Whether you are handling sensitive financial records, personal identification documents, or simply want to keep a digital diary private, understanding how file encryption works is the first step toward true digital sovereignty.</p>
                
                <p>This tool, the File Security Tool by Tool Baba, provides a robust, browser-based solution to password-protect any file type without ever sending your data to a server. Below, we explore the mechanics of encryption, the importance of robust passwords, and why client-side security is the gold standard for privacy.</p>

                <h3>What Is File Encryption?</h3>
                <p>At its core, file encryption is the process of converting readable data (plaintext) into an unreadable format (ciphertext) using a mathematical algorithm and a secret key (your password). Without the key, the data appears as a meaningless jumble of random characters. This ensures that even if a hacker gains access to your files, they cannot read the contents without the correct password.</p>
                <p>Unlike simple "password protection" found in some office software—which often just puts a lock on the front door but leaves the windows open—true encryption scrambles the actual content of the file byte by byte.</p>

                <h3>How This Tool Works: The Power of AES-GCM</h3>
                <p>We believe in transparency, especially when it comes to security. This tool utilizes the <strong>Web Crypto API</strong>, a native feature built into modern web browsers that allows for cryptographic operations to happen much faster and more securely than traditional JavaScript libraries.</p>
                
                <p>Specifically, we use the <strong>AES-GCM (Advanced Encryption Standard - Galois/Counter Mode)</strong> algorithm. Here is a simplified breakdown of the process:</p>
                <ul>
                    <li><strong>Salt Generation:</strong> When you encrypt a file, we generate a unique, random "salt." This ensures that even if you use the same password for two different files, the encrypted output will look completely different.</li>
                    <li><strong>Key Derivation (PBKDF2):</strong> Your password is not used directly as the encryption key. Instead, we use PBKDF2 (Password-Based Key Derivation Function 2) to stretch your password into a highly secure cryptographic key. This makes it incredibly difficult for attackers to guess your password using brute-force methods.</li>
                    <li><strong>Initialization Vector (IV):</strong> We generate a random IV for every encryption task. This adds another layer of randomness to the encryption process.</li>
                    <li><strong>Encryption:</strong> The file data is encrypted using the derived key and the IV.</li>
                    <li><strong>Packaging:</strong> The Salt, IV, and Encrypted Data are combined into a single file with the <code>.secure</code> extension.</li>
                </ul>

                <h3>Why Client-Side Encryption Matters</h3>
                <p>Most online file converters or protection tools require you to upload your file to their server. This poses a massive privacy risk. Once your file leaves your computer, you have lost control over it. The server owner could view, copy, or store your data without your knowledge.</p>
                
                <p><strong>Our tool is different.</strong> It runs entirely in your web browser. No data is ever sent to a server. The encryption and decryption happen locally on your device's CPU. This means:</p>
                <ul>
                    <li><strong>Zero Knowledge:</strong> We do not know your password, and we do not see your files.</li>
                    <li><strong>Speed:</strong> Since there is no uploading or downloading from a cloud server, large files are processed instantly based on your computer's speed.</li>
                    <li><strong>Security:</strong> Your sensitive data never traverses the internet, eliminating the risk of "man-in-the-middle" attacks.</li>
                </ul>

                <h3>Real-Life Use Cases for File Encryption</h3>
                <p>Who needs file encryption? The short answer: everyone. Here are some common scenarios where this tool is indispensable:</p>
                
                <p><strong>1. Storing Identification Documents</strong><br>
                Many of us keep scans of passports, driver's licenses, and birth certificates on our computers or cloud storage for easy access. If your cloud account is hacked, identity theft is a real risk. Encrypting these PDFs or images before uploading them ensures that only you can view them.</p>

                <p><strong>2. Financial Records and Tax Returns</strong><br>
                Tax documents contain your social security number, address, and income details—a goldmine for fraudsters. Always encrypt tax returns before emailing them to your accountant or storing them in a backup drive.</p>

                <p><strong>3. Sharing Sensitive Work Data</strong><br>
                If you need to send a confidential client list or a proprietary project file via email or Slack, encrypt it first. Send the encrypted file through one channel (like email) and the password through another (like a secure messaging app like Signal). This is a standard security practice known as "out-of-band" authentication.</p>

                <h3>What Happens If I Lose My Password?</h3>
                <p>This is the most critical warning we can give: <strong>If you lose your password, your data is gone forever.</strong></p>
                <p>Because this tool uses military-grade AES encryption, there is no "backdoor" and no "password reset" button. We do not store your password, so we cannot recover it for you. This is a feature, not a bug—it confirms that the security is real. If a reset were possible, it would mean the encryption was weak enough to be bypassed.</p>
                <p>We strongly recommend using a reputable Password Manager to store the credentials for your encrypted files.</p>

                <h3>Mobile vs. Desktop Experience</h3>
                <p>While this tool is fully responsive and works on mobile devices, encryption is a mathematically intensive task. Modern smartphones are powerful, but for very large files (over 500MB), we recommend using a desktop or laptop computer. The memory management on desktop browsers is generally more robust for handling large data blobs.</p>

                <h3>The Difference Between "Locking" and "Encrypting"</h3>
                <p>You may have seen apps that "lock" photos or folders. Often, these apps simply hide the file from the system's file explorer or change the file extension. A tech-savvy user can easily unhide them. Encryption, however, mathematically alters the data. Even if someone opens the file in a hex editor, they will only see random noise. This tool provides true encryption, not just obfuscation.</p>

                <h2>Conclusion</h2>
                <p>Security is a process, not a product. By using this File Security Tool, you are taking a proactive step in managing your digital footprint. Remember that the strength of the encryption is only as good as the strength of your password. Avoid using common words like "password123" or names of pets. Use a long passphrase with a mix of characters for maximum security.</p>
                <p>This tool is provided lifetime free by Tool Baba to help make the internet a safer place. Bookmark this page, share it with friends, and keep your data safe.</p>
            </div>
        </div>
    </div>

    <script>
        // DOM Elements
        const fileInput = document.getElementById('fileInput');
        const passwordInput = document.getElementById('password');
        const confirmPasswordInput = document.getElementById('confirmPassword');
        const confirmGroup = document.getElementById('confirmGroup');
        const actionBtn = document.getElementById('actionBtn');
        const btnText = document.getElementById('btnText');
        const spinner = document.getElementById('spinner');
        const outputArea = document.getElementById('outputArea');
        const statusMessage = document.getElementById('statusMessage');
        const downloadLink = document.getElementById('downloadLink');
        const strengthBar = document.getElementById('strengthBar');

        let currentMode = 'encrypt'; // 'encrypt' or 'decrypt'

        // Constants for Encryption
        const PBKDF2_ITERATIONS = 100000;
        const SALT_LENGTH = 16;
        const IV_LENGTH = 12;

        // Event Listeners
        passwordInput.addEventListener('input', checkStrength);

        function switchMode(mode) {
            currentMode = mode;
            
            // UI Updates
            document.getElementById('mode-encrypt').classList.toggle('active', mode === 'encrypt');
            document.getElementById('mode-decrypt').classList.toggle('active', mode === 'decrypt');
            
            if (mode === 'encrypt') {
                confirmGroup.style.display = 'block';
                btnText.textContent = 'Encrypt File';
                fileInput.value = '';
            } else {
                confirmGroup.style.display = 'none';
                btnText.textContent = 'Decrypt File';
                fileInput.value = '';
            }

            // Reset Output
            outputArea.style.display = 'none';
            statusMessage.textContent = '';
            statusMessage.className = 'status-message';
        }

        function checkStrength() {
            const val = passwordInput.value;
            let strength = 0;
            if (val.length > 5) strength += 20;
            if (val.length > 10) strength += 20;
            if (/[A-Z]/.test(val)) strength += 20;
            if (/[0-9]/.test(val)) strength += 20;
            if (/[^A-Za-z0-9]/.test(val)) strength += 20;

            strengthBar.style.width = strength + '%';
            
            if (strength < 40) strengthBar.style.backgroundColor = '#ef4444';
            else if (strength < 80) strengthBar.style.backgroundColor = '#f59e0b';
            else strengthBar.style.backgroundColor = '#10b981';
        }

        async function processFile() {
            // Validation
            const file = fileInput.files[0];
            const password = passwordInput.value;

            if (!file) {
                alert('Please select a file first.');
                return;
            }
            if (!password) {
                alert('Please enter a password.');
                return;
            }

            if (currentMode === 'encrypt') {
                const confirm = confirmPasswordInput.value;
                if (password !== confirm) {
                    alert('Passwords do not match.');
                    return;
                }
            }

            // UI Loading State
            actionBtn.disabled = true;
            btnText.style.display = 'none';
            spinner.style.display = 'block';
            outputArea.style.display = 'none';

            try {
                const fileData = await readFileArrayBuffer(file);
                
                if (currentMode === 'encrypt') {
                    await encryptFile(file, fileData, password);
                } else {
                    await decryptFile(file, fileData, password);
                }

            } catch (error) {
                console.error(error);
                showStatus(error.message || 'An error occurred during processing.', false);
            } finally {
                // Reset UI
                actionBtn.disabled = false;
                btnText.style.display = 'inline';
                spinner.style.display = 'none';
            }
        }

        function readFileArrayBuffer(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => resolve(reader.result);
                reader.onerror = () => reject(new Error('Failed to read file'));
                reader.readAsArrayBuffer(file);
            });
        }

        async function encryptFile(file, data, password) {
            const textEncoder = new TextEncoder();
            
            // 1. Generate Random Salt and IV
            const salt = window.crypto.getRandomValues(new Uint8Array(SALT_LENGTH));
            const iv = window.crypto.getRandomValues(new Uint8Array(IV_LENGTH));

            // 2. Import Password
            const keyMaterial = await window.crypto.subtle.importKey(
                "raw",
                textEncoder.encode(password),
                { name: "PBKDF2" },
                false,
                ["deriveKey"]
            );

            // 3. Derive Key
            const key = await window.crypto.subtle.deriveKey(
                {
                    name: "PBKDF2",
                    salt: salt,
                    iterations: PBKDF2_ITERATIONS,
                    hash: "SHA-256"
                },
                keyMaterial,
                { name: "AES-GCM", length: 256 },
                false,
                ["encrypt"]
            );

            // 4. Encrypt Data
            const encryptedContent = await window.crypto.subtle.encrypt(
                {
                    name: "AES-GCM",
                    iv: iv
                },
                key,
                data
            );

            // 5. Combine Salt + IV + Encrypted Data
            const finalBuffer = new Uint8Array(salt.byteLength + iv.byteLength + encryptedContent.byteLength);
            finalBuffer.set(salt, 0);
            finalBuffer.set(iv, salt.byteLength);
            finalBuffer.set(new Uint8Array(encryptedContent), salt.byteLength + iv.byteLength);

            // 6. Create Blob and Download Link
            const blob = new Blob([finalBuffer], { type: "application/octet-stream" });
            const url = URL.createObjectURL(blob);
            
            downloadLink.href = url;
            downloadLink.download = file.name + ".secure";
            downloadLink.textContent = "Download Secured File";
            
            showStatus("File Encrypted Successfully!", true);
        }

        async function decryptFile(file, data, password) {
            const textEncoder = new TextEncoder();
            const dataArray = new Uint8Array(data);

            // 1. Extract Salt and IV
            if (dataArray.byteLength < SALT_LENGTH + IV_LENGTH) {
                throw new Error("File is too small to be valid.");
            }

            const salt = dataArray.slice(0, SALT_LENGTH);
            const iv = dataArray.slice(SALT_LENGTH, SALT_LENGTH + IV_LENGTH);
            const encryptedContent = dataArray.slice(SALT_LENGTH + IV_LENGTH);

            try {
                // 2. Import Password
                const keyMaterial = await window.crypto.subtle.importKey(
                    "raw",
                    textEncoder.encode(password),
                    { name: "PBKDF2" },
                    false,
                    ["deriveKey"]
                );

                // 3. Derive Key (Must be exact same parameters as encryption)
                const key = await window.crypto.subtle.deriveKey(
                    {
                        name: "PBKDF2",
                        salt: salt,
                        iterations: PBKDF2_ITERATIONS,
                        hash: "SHA-256"
                    },
                    keyMaterial,
                    { name: "AES-GCM", length: 256 },
                    false,
                    ["decrypt"]
                );

                // 4. Decrypt Data
                const decryptedContent = await window.crypto.subtle.decrypt(
                    {
                        name: "AES-GCM",
                        iv: iv
                    },
                    key,
                    encryptedContent
                );

                // 5. Create Blob and Download Link
                // Try to remove .secure extension if present
                let originalName = file.name;
                if (originalName.endsWith('.secure')) {
                    originalName = originalName.slice(0, -7);
                } else {
                    originalName = "decrypted-" + originalName;
                }

                const blob = new Blob([decryptedContent], { type: "application/octet-stream" });
                const url = URL.createObjectURL(blob);

                downloadLink.href = url;
                downloadLink.download = originalName;
                downloadLink.textContent = "Download Original File";
                
                showStatus("File Decrypted Successfully!", true);

            } catch (e) {
                throw new Error("Decryption failed. Wrong password or corrupted file.");
            }
        }

        function showStatus(msg, isSuccess) {
            outputArea.style.display = 'block';
            statusMessage.textContent = msg;
            statusMessage.className = isSuccess ? 'status-message success' : 'status-message error';
            
            if (isSuccess) {
                downloadLink.style.display = 'inline-block';
            } else {
                downloadLink.style.display = 'none';
            }
        }
    </script>
</body>
</html>